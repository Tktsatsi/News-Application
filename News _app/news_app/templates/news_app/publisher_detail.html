{% extends 'news_app/base.html' %}
{% load static %}

{% block title %}{{ publisher.name }} - News App{% endblock %}

<link rel="stylesheet" href="{% static 'news_app/publishers.css' %}">

{% block extra_css %}{% endblock %}

{% block content %}
    <div class="publisher-hero">
        <div class="publisher-icon">ğŸ¢</div>
        <h1 class="publisher-title-main">{{ publisher.name }}</h1>
        
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-number">{{ publisher.articles.count }}</div>
                <div class="stat-label">Published Articles</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">{{ publisher.newsletters.count }}</div>
                <div class="stat-label">Newsletters</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">{{ publisher.members.count }}</div>
                <div class="stat-label">Team Members</div>
            </div>
        </div>
    </div>
    
    <div class="publisher-content-section">
        <h3 style="color: #333; margin-bottom: 20px;">ğŸ“– About {{ publisher.name }}</h3>
        {{ publisher.description|safe }}
    </div>
    
    {% if publisher.articles.exists %}
    <div class="section-header">
        <h2 class="section-title">Latest Articles</h2>
    </div>
    
    <div class="article-grid">
        {% for article in publisher.articles.all|slice:":6" %}
        <div class="article-card" onclick="window.location.href='{% url 'article_detail' article.pk %}'">
            {% if article.image %}
            <div class="article-image">
                <img src="{{ article.image.url }}" alt="{{ article.title }}">
            </div>
            {% else %}
            <div class="article-placeholder">
                ğŸ“°
            </div>
            {% endif %}
            
            <div class="article-content">
                <h3 class="article-title">{{ article.title }}</h3>
                
                <div class="article-meta">
                    <div class="meta-item">
                        <span>By</span>
                        <span style="color: #667eea; font-weight: 600;">{{ article.author.username }}</span>
                    </div>
                    <div class="meta-item">
                        ğŸ“… {{ article.published_date|date:"M d, Y" }}
                    </div>
                </div>
                
                {% if article.summary %}
                <p class="article-summary">{{ article.summary }}</p>
                {% endif %}
                
                <a href="{% url 'article_detail' article.pk %}" class="read-more">
                    Read More â†’
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    
    {% if publisher.newsletters.exists %}
    <div class="section-header">
        <h2 class="section-title">Newsletters</h2>
    </div>
    
    {% for newsletter in publisher.newsletters.all %}
    <div class="newsletter-card">
        <h3>ğŸ“§ {{ newsletter.title }}</h3>
        <p>{{ newsletter.description|truncatewords:30 }}</p>
        <div style="display: flex; gap: 10px; align-items: center;">
            <span style="color: #999; font-size: 0.9em;">ğŸ‘¥ {{ newsletter.subscribers.count }} subscribers</span>
            <a href="{% url 'newsletter_detail' newsletter.pk %}" class="btn btn-secondary btn-sm">
                View Newsletter â†’
            </a>
        </div>
    </div>
    {% endfor %}
    {% endif %}
    
    {% if not publisher.articles.exists and not publisher.newsletters.exists %}
    <div class="empty-state">
        <div class="empty-state-icon">ğŸ“°</div>
        <h3>No Content Yet</h3>
        <p>This publisher hasn't published any articles or newsletters yet.</p>
    </div>
    {% endif %}
    
    <div class="action-buttons">
        <a href="{% url 'publisher_list' %}" class="btn btn-secondary">
            â† Back to Publishers
        </a>
        
        {% if user.is_authenticated %}
            {% if user.role == 'publisher' and user.publisher == publisher %}
                <a href="{% url 'publisher_dashboard' %}" class="btn btn-primary">
                    ğŸ“Š Dashboard
                </a>
            {% endif %}
            {% if can_request_join %}
                <a href="{% url 'request_join_publisher' publisher.pk %}" class="btn btn-primary">
                    ğŸ“ Request to Join
                </a>
            
            {% endif %}
        {% endif %}
    </div>
{% endblock %}
